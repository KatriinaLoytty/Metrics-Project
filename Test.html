<!doctype html>
<html lang="en">
	<head>
		<meta charset = "UTF-8" />
		<meta name="viewport" content="width=device-width" />

		<title>Mock-up</title>

		<!--CSS-->
		<!--
		<link rel="stylesheet" type="text/css" href="css/ht_style.css"/>
		<link rel="stylesheet" type="text/css" href="css/ht_transition.css"/>
		<link href='http://fonts.googleapis.com/css?family=Rochester' rel='stylesheet' type='text/css'>
		-->

		<!--JavaScript-->

		<script src="scripts/jquery-1.11.1.min.js"></script>
		<script src="scripts/Chart.js-master/Chart.js"></script>
	</head>

	<body>

		<div>
			<b>Time:</b><span id="to"></span>
			<br>
			<b>From:</b><span id="from"></span>
			<br>
			<b>heading:</b><span id="heading"></span>
			<br>
			<b>Message:</b><span id="message"></span>
		</div>
		<br/>
		<input type="button" value="send" onclick="clicked()"/>

		<br/>
		<br/>
		<hr>
		<br/>
		<br/>

		<form action="">
			<input id="woHoursCB" type="checkbox" name="Workinghours" onclick="validate()">
			Working Hours
			<br>
			<input id="requireCB" type="checkbox" name="Requirements" onclick="validate()">
			Requirements
		</form>

		<br/>
		<br/>
		<hr>
		<br/>
		<br/>

		<!--HTML5 canvas used to display charts-->

		<div id="div1" style="width:30%">
			<canvas id="canvas" height="450" width="600"></canvas>
		</div>

		<script>
			//Opens the .xml
			if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
				xmlhttp = new XMLHttpRequest();
			} else {// code for IE6, IE5
				xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
			}
			xmlhttp.open("GET", "test.xml", false);
			xmlhttp.send();
			xmlDoc = xmlhttp.responseXML;

			//Saves xml nodes into variables
			var time = xmlDoc.getElementsByTagName("Time")[0].childNodes[0].nodeValue;
			var from = xmlDoc.getElementsByTagName("from")[0].childNodes[0].nodeValue;
			;
			var heading = xmlDoc.getElementsByTagName("heading")[0].childNodes[0].nodeValue;
			;
			var body = xmlDoc.getElementsByTagName("body")[0].childNodes[0].nodeValue;
			;

			//Sets html span elements to show the loaded data.
			document.getElementById("to").innerHTML = time;
			document.getElementById("from").innerHTML = from;
			document.getElementById("heading").innerHTML = heading;
			document.getElementById("message").innerHTML = body;

			//Puts the variables in an array. Ready to be sent forward.
			var reportData = {
				time : "" + time,
				from : "" + from,
				heading : "" + heading,
				body : "" + body
			};

			//Sends the data for intodb.php to process forward
			function clicked() {
				$.ajax({
					url : "intodb.php",
					type : "POST",
					data : reportData,
					success : function(data) {
						//console.log( data );
						//data - response from server
					},
					error : function(errorThrown) {
						//console.log( data );
						console.log("error");
					},
				});
			}

			//CHARTS

			var randomScalingFactor = function() {
				return Math.round(Math.random() * 50);
			};
			var lineChartData = {
				labels : ["January", "February", "March", "April", "May", "June", "July"],
				datasets : [{
					label : "My First dataset",
					fillColor : "rgba(220,220,220,0.2)",
					strokeColor : "rgba(220,220,220,1)",
					pointColor : "rgba(220,220,220,1)",
					pointStrokeColor : "#fff",
					pointHighlightFill : "#fff",
					pointHighlightStroke : "rgba(220,220,220,1)",
					data : [randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor()]
				}, {
					label : "My Second dataset",
					fillColor : "rgba(151,187,205,0.2)",
					strokeColor : "rgba(151,187,205,1)",
					pointColor : "rgba(151,187,205,1)",
					pointStrokeColor : "#fff",
					pointHighlightFill : "#fff",
					pointHighlightStroke : "rgba(151,187,205,1)",
					data : [1, 10, 20, 10, 50, 35, 1]
				}]

			};

			// Checkboxes
			function validate() {

				var lineChartData = {
					labels : ["January", "February", "March", "April", "May", "June", "July"],
					datasets : [{
						label : "My First dataset",
						fillColor : "rgba(220,220,220,0.2)",
						strokeColor : "rgba(220,220,220,1)",
						pointColor : "rgba(220,220,220,1)",
						pointStrokeColor : "#fff",
						pointHighlightFill : "#fff",
						pointHighlightStroke : "rgba(220,220,220,1)",
						data : [randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor()]
					}]
				};

				var parent = document.getElementById("div1");
				var child = document.getElementById("canvas");

				// if just Working hours check box is checked
				if (document.getElementById('woHoursCB').checked == true) {
					// create canvas if its not exist
					if (child == null) {
						var newchild = document.createElement('canvas');
						newchild.id = "canvas";
						newchild.width = 600;
						newchild.height = 450;
						parent.appendChild(newchild);
					}

					var ctx = document.getElementById("canvas").getContext("2d");
					window.myLine = new Chart(ctx).Line(lineChartData, {
						responsive : true
					});
				} else if (document.getElementById('woHoursCB').checked == false) {
					// remove chart
					parent.removeChild(child);
				}
			}

		</script>

	</body>
</html>
