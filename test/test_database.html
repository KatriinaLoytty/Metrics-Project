<!doctype html>
<html lang="en">
	<head>
		<meta charset = "UTF-8" />
		<meta name="viewport" content="width=device-width" />

		<title>Mock-up</title>

		<!--CSS-->
		<!--
		<link rel="stylesheet" type="text/css" href="css/ht_style.css"/>
		<link rel="stylesheet" type="text/css" href="css/ht_transition.css"/>
		<link href='http://fonts.googleapis.com/css?family=Rochester' rel='stylesheet' type='text/css'>
		-->

		<!--JavaScript-->

		<script src="scripts/jquery-1.11.1.min.js"></script>
		<script src="scripts/Chart.js-master/Chart.js"></script>
	</head>

	<body>

		<div>
			<b>Time:</b><span id="to"></span>
			<br>
			<b>From:</b><span id="from"></span>
			<br>
			<b>heading:</b><span id="heading"></span>
			<br>
			<b>Message:</b><span id="message"></span>
		</div>
		<br/>
		<input type="button" value="send" onclick="clicked()"/>

		<br/>
		<br/>
		<hr>
		<br/>
		<br/>

		<div id="checkboxes1">
			<input id="woHoursCB" type="checkbox" name="Workinghours" onclick="validate()">
			Working Hours
			<br>
			<input id="requireCB" type="checkbox" name="Requirements" onclick="validate()">
			Requirements
		</div>

		<br/>
		<br/>
		<hr>
		<br/>
		<br/>

		<!--HTML5 canvas used to display charts-->

		<div id="div1" style="width:30%">
			<canvas id="canvas" height="450" width="600"></canvas>
		</div>

		<script>
			//Opens the .xml
			if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
				xmlhttp = new XMLHttpRequest();
			} else {// code for IE6, IE5
				xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
			}
			xmlhttp.open("GET", "test.xml", false);
			xmlhttp.send();
			xmlDoc = xmlhttp.responseXML;

			//Saves xml nodes into variables
			var time = xmlDoc.getElementsByTagName("Time")[0].childNodes[0].nodeValue;
			var from = xmlDoc.getElementsByTagName("from")[0].childNodes[0].nodeValue;
			;
			var heading = xmlDoc.getElementsByTagName("heading")[0].childNodes[0].nodeValue;
			;
			var body = xmlDoc.getElementsByTagName("body")[0].childNodes[0].nodeValue;
			;

			//Sets html span elements to show the loaded data.
			document.getElementById("to").innerHTML = time;
			document.getElementById("from").innerHTML = from;
			document.getElementById("heading").innerHTML = heading;
			document.getElementById("message").innerHTML = body;

			//Puts the variables in an array. Ready to be sent forward.
			var reportData = {
				time : "" + time,
				from : "" + from,
				heading : "" + heading,
				body : "" + body
			};

			//Sends the data for intodb.php to process forward
			function clicked() {
				$.ajax({
					url : "intodb.php",
					type : "POST",
					data : reportData,
					success : function(data) {
						//console.log( data );
						//data - response from server
					},
					error : function(errorThrown) {
						//console.log( data );
						console.log("error");
					},
				});
			}

			//CHARTS

			var randomScalingFactor = function() {
				return Math.round(Math.random() * 50);
			};

			// Checkboxes
			function validate() {
				// charts
				var hRow = ["January", "February", "March", "April", "May", "June", "July"];
				// TODO ROW will change upon more charts
				var vRow = [];
				vRow[0] = [20, 4, 25, 10];
				vRow[1] = [45, 55, 65, 2];

				// Place all checkboxes from dev into checkboxes varible
				var checkboxes = [];
				var searchEles = document.getElementById("checkboxes1").children;
				for (var i = 0; i < searchEles.length; i++) {
					if (searchEles[i].tagName == 'INPUT') {
						checkboxes.push(searchEles[i]);
					}
				}

				var ds = [];

				// itarate through checkboxes and add the points
				for (var i = 0, len = checkboxes.length, j = 0; i < len; i++) {
					if (checkboxes[i].checked) {
						// show checkboxes[i]
						ds[j] = {
							label : "My First dataset",
							fillColor : "rgba(220,220,220,0.2)",
							strokeColor : "rgba(220,220,220,1)",
							pointColor : "rgba(220,220,220,1)",
							pointStrokeColor : "#fff",
							pointHighlightFill : "#fff",
							pointHighlightStroke : "rgba(220,220,220,1)",
							data : vRow[j]
						};
						j++;
					}
				}

				var lineChartData = {
					labels : hRow,
					datasets : ds
				};

				// remove canvas
				var parent = document.getElementById("div1");
				var child = document.getElementById("canvas");
				parent.removeChild(child);
				// recreate it 
				var child = document.getElementById("canvas");
				if (child == null) {
					var newchild = document.createElement('canvas');
					newchild.id = "canvas";
					newchild.width = 600;
					newchild.height = 450;
					parent.appendChild(newchild);
				}

				// create a chart
				var ctx = document.getElementById("canvas").getContext("2d");
				new Chart(ctx).Line(lineChartData, {
					responsive : true
				});
			}

		</script>

	</body>
</html>